!���뻮�ֺõ�����Ԫģ��
/CWD,'G:\RESEARCH\MasterThesis\ANSYS_SD\ANSYS_GUI\NewAlgorithm'
RESUME,'complex3D_grid_hex','db','G:\Research\GitProject\Topology Optimization for Both Structure and Material\NewAlgorithm',0,0
/FILENAME,complex3D_grid_hex,1
/TITLE,get_meshmodel_data 

!��ȡ��Ԫ���ͽڵ���
*GET,ELEMSUM,ELEMENT,0,COUNT
*GET,NODESUM,NODE,0,COUNT

!��������������������
/SOL
ANTYPE,0

!��ȡANSYS�ĵ�Ԫ�նȾ���
/OUTPUT,elements_stiffness,out,,
/DEBUG,-1,,,1

!���
/STATUS,SOLU
SOLVE

!��ȡ��Ԫ�����ڵ���
*DIM,ELEMENTS_NODES,ARRAY,ELEMSUM,8
*VGET,ELEMENTS_NODES(1,1),ELEM,1,NODE,1
*VGET,ELEMENTS_NODES(1,2),ELEM,1,NODE,2
*VGET,ELEMENTS_NODES(1,3),ELEM,1,NODE,3
*VGET,ELEMENTS_NODES(1,4),ELEM,1,NODE,4
*VGET,ELEMENTS_NODES(1,5),ELEM,1,NODE,5
*VGET,ELEMENTS_NODES(1,6),ELEM,1,NODE,6
*VGET,ELEMENTS_NODES(1,7),ELEM,1,NODE,7
*VGET,ELEMENTS_NODES(1,8),ELEM,1,NODE,8

!��ȡ��Ԫ��������
*DIM,ELEMENTS_CENTERS,ARRAY,ELEMSUM,3
*VGET,ELEMENTS_CENTERS(1,1),ELEM,1,CENT,X
*VGET,ELEMENTS_CENTERS(1,2),ELEM,1,CENT,Y
*VGET,ELEMENTS_CENTERS(1,3),ELEM,1,CENT,Z

!��ȡ�ڵ�����
*DIM,NODES_COORDINATE,ARRAY,NODESUM,3
*VGET,NODES_COORDINATE(1,1),NODE,1,LOC,X
*VGET,NODES_COORDINATE(1,2),NODE,1,LOC,Y
*VGET,NODES_COORDINATE(1,3),NODE,1,LOC,Z

!��ȡ��Ԫ���
*DIM,ELEMENTS_VOLUMN,ARRAY,ELEMSUM,1
*VGET,ELEMENTS_VOLUMN(1,1),ELEM,1,GEOM

!�洢��Ԫ���ͽڵ���
*CFOPEN,elements_nodes_counts,txt 
*VWRITE,ELEMSUM,NODESUM
%10I    %10I
*CFCLOS

!�洢��Ԫ�����ڵ���
*CFOPEN,elements_nodes,txt
*VWRITE,ELEMENTS_NODES(1,1), ELEMENTS_NODES(1,2),ELEMENTS_NODES(1,3),ELEMENTS_NODES(1,4),ELEMENTS_NODES(1,5),ELEMENTS_NODES(1,6),ELEMENTS_NODES(1,7),ELEMENTS_NODES(1,8)
%10I    %10I    %10I    %10I    %10I    %10I    %10I    %10I
*CFCLOS
!�洢��Ԫ��������
*CFOPEN,elements_centers,txt
*VWRITE,SEQU,ELEMENTS_CENTERS(1,1), ELEMENTS_CENTERS(1,2),ELEMENTS_CENTERS(1,3)
%10I  %15.10f  %15.10f  %15.10f
!�洢��Ԫ���
*CFOPEN,elements_volumn,txt
*VWRITE,SEQU,ELEMENTS_VOLUMN(1,1)
%10I    %20.10f 

!�洢�ڵ�����
*CFOPEN,node_coordinates,txt
*VWRITE,NODES_COORDINATE(1,1),NODES_COORDINATE(1,2),NODES_COORDINATE(1,3)
%15.10f  %15.10f  %15.10f

!for 3D project
*DIM,connectedelem,ARRAY,100,ELEMSUM
*DIM,neibors,ARRAY,ELEMSUM,100

*DO,i,1,ELEMSUM
ESEL,S, , ,i
NSLE,S
ESLN,S
*VGET,connectedelem(1,i),ELEM,,ELIST
*ENDDO

ALLSEL,ALL

*MFUN,neibors(1,1),TRAN,connectedelem(1,1)

*MWRITE,neibors(1,1),neibors,txt,,JIK,27,ELEMSUM,1
(27F10.0)
*CFCLOS
!���沢�˳�     
SAVE
FINISH
exit